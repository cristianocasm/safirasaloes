<%- sc = @schedule -%>

<% if sc.persisted? %>
    var myEvent = {
      id:    <%= sc.id %>,
      title: '<%= sc.nome %>',
      email: '<%= sc.email %>',
      nome: '<%= sc.nome %>',
      telefone: '<%= sc.telefone %>',
      service: '<%= sc.price.nome %>',
      start: '<%= sc.datahora_inicio.strftime("%Y-%m-%d %H:%M:%S") %>',
      end:   '<%= sc.datahora_fim.strftime("%Y-%m-%d %H:%M:%S") %>'
    };
  $('#calendar').fullCalendar('removeEvents', <%= sc.id %>);
  $("#calendar").fullCalendar('renderEvent', myEvent);
  $("#myModal").modal('hide');
<% elsif sc.errors.added?(:professional_id, :blank) || 
         sc.errors.added?(:price_id, :blank) ||
         sc.errors.added?(:datahora_inicio, :blank) ||
         sc.errors.added?(:datahora_inicio, :after_or_equal_to) ||
         sc.errors.added?(:datahora_fim, :after) ||
         sc.errors.added?(:email, "formato incorreto") || 
         sc.errors.added?(:base, "Informe Nome e/ou Email e/ou Telefone do cliente")%>
  $('#errors').empty()
  $('#errors').append('<%= flash_messages %>')
<% else %>
  $("#myModal").modal('hide')
  $("#myModalError").modal('show')
<% end %>