<%- sc = @schedule -%>

<% if sc.persisted? %>
  var myEvent = {
    id:    <%= sc.id %>,
    title: '<%= sc.nome %>',
    nome: '<%= sc.nome %>',
    telefone: '<%= sc.telefone %>',
    price: '<%= sc.price.nome %>',
    start: '<%= sc.datahora_inicio.strftime("%Y-%m-%d %H:%M:%S") %>',
    end:   '<%= sc.datahora_fim.strftime("%Y-%m-%d %H:%M:%S") %>'
  };
  $('#calendar').fullCalendar('removeEvents', <%= sc.id %>);
  $("#calendar").fullCalendar('renderEvent', myEvent);
  $("#myModal").modal('hide');
  if(window.started) { window.tour.next(4); }
  $('div#calendar_feedback').html('<% flash_messages() %>');
  <% if current_professional.creating_first_service? %>
    if($("div#service_field>input#schedule_price_attributes_service_nome").length) {
      $("div#service_field").html('<%= select_tag :schedule_price_id, options_from_collection_for_select(current_professional.prices.includes(:service), "id", "nome"), name: "schedule[price_id]", class: "form-control input-lg" %>');
      $("#schedule_price_id").val("<%= sc.price_id %>");
    }
  <% end %>
<% else %>
  $('#errors').empty()
  $('#errors').append('<%= flash_messages %>')
<% end %>