/*
  edit_schedule.js.erb preenche o formulário de schedule com
  os dados do objeto a ser editado e ativa o modal que contem
  o formulário.
*/

<%- sc = @schedule -%>
<%- rws = sc.get_rewards_by_customer_and_professional -%>

$("#schedule_nome").val("<%= sc.nome %>")
$("#schedule_email").typeahead('val', "<%= sc.email %>")
$("#schedule_telefone").typeahead('val', "<%= sc.telefone %>")
$("#schedule_customer_id").val(<%= sc.customer_id %>)
$("#schedule_price_id").val(<%= sc.price_id %>)
$("#schedule_id").val(<%= sc.id %>)
// Tratando o dia e hora marcado para o início do atendimento
$("#schedule_datahora_inicio_3i").val(<%= sc.datahora_inicio.day %>)
$("#schedule_datahora_inicio_2i").val(<%= sc.datahora_inicio.month %>)
$("#schedule_datahora_inicio_1i").val(<%= sc.datahora_inicio.year %>)
$("#schedule_datahora_inicio_4i").val(pad2(<%= sc.datahora_inicio.hour %>))
$("#schedule_datahora_inicio_5i").val(pad2(<%= sc.datahora_inicio.min %>))
// Tratando o dia e hora marcado para o final do atendimento
$("#schedule_datahora_fim_3i").val(<%= sc.datahora_fim.day  %>)
$("#schedule_datahora_fim_2i").val(<%= sc.datahora_fim.month %>)
$("#schedule_datahora_fim_1i").val(<%= sc.datahora_fim.year %>)
$("#schedule_datahora_fim_4i").val(pad2(<%= sc.datahora_fim.hour %>))
$("#schedule_datahora_fim_5i").val(pad2(<%= sc.datahora_fim.min %>))
// Tratando utilização de Safiras para pagamento
<% if sc.pago_com_safiras %>
  $('input#schedule_pago_com_safiras').prop('disabled', false)
  $('input#schedule_pago_com_safiras').prop('checked', true)
  $("input#total_safiras").val('<%= rws.total_safiras %>')
  $('span#pagamento_com_safiras').show()
<% elsif rws.present? && rws.total_safiras >= (sc.price.preco * 2) %>
  $('input#schedule_pago_com_safiras').prop('disabled', false)
  $("input#total_safiras").val('<%= rws.total_safiras %>')
  $('span#pagamento_com_safiras').show()
<% end %>
// Ativando o modal
$("#myModal").modal('show');

function pad2(number){
  return (number < 10 ? '0' : '') + number
}